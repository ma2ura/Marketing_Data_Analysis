{
  "hash": "fabe03ac3a1869f127720ed87594603d",
  "result": {
    "engine": "knitr",
    "markdown": "## 第5章\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# コード5-1\npacman::p_load(tidyverse, readxl, pwr,knitr)\n\n# コード5-2\nset.seed(442)\ndie <- 1:6\nd <- sample(die, size = 1, replace = TRUE)\nd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6\n```\n\n\n:::\n\n```{.r .cell-code}\n# コード5-3\nset.seed(352)\nd1 <- sample(die, size = 10, replace = TRUE)\nd2 <- sample(die, size = 10, replace = TRUE)\nd3 <- sample(die, size = 10, replace = TRUE)\nd_mean <- matrix(c(mean(d1), mean(d2), mean(d3)), nrow = 1)\ncolnames(d_mean) <- c(\"d1 の平均\", \"d2 の平均\", \"d3 の平均\")\nknitr::kable(d_mean, caption = \"サイコロの標本平均比較\", align = \"ccc\")\n```\n\n::: {.cell-output-display}\n\n\nTable: サイコロの標本平均比較\n\n| d1 の平均 | d2 の平均 | d3 の平均 |\n|:---------:|:---------:|:---------:|\n|    3.2    |     3     |    2.4    |\n\n\n:::\n\n```{.r .cell-code}\n# コード5-4\nset.seed(541)\nd10 <- sample(die, size = 10, replace = TRUE)\nd100 <- sample(die, size = 100, replace = TRUE)\nd1000 <- sample(die, size = 1000, replace = TRUE)\nd_lln <- matrix(c(mean(d10), mean(d100), mean(d1000)), nrow = 1)\ncolnames(d_lln) <- c(\"10 回試行の平均\", \"100 回試行の平均\", \"1,000 回試行の平均\")\nknitr::kable(d_lln, caption = \"サイコロの標本平均比較 2\", align = \"ccc\")\n```\n\n::: {.cell-output-display}\n\n\nTable: サイコロの標本平均比較 2\n\n| 10 回試行の平均 | 100 回試行の平均 | 1,000 回試行の平均 |\n|:---------------:|:----------------:|:------------------:|\n|        3        |       3.36       |       3.516        |\n\n\n:::\n\n```{.r .cell-code}\n# コード5-5\nbulb <- c(\n  1939.6, 1680.3, 1982.1, 2215.6,\n  2092.5, 1928.9, 2003.8, 1955.5,\n  1800.1, 1659.5, 2066.2, 2107.2,\n  2085.5, 1878.6, 2007.6, 1816.1)\nbulb_ci <- t.test(bulb) # t検定の実施と格納\nbulb_ci$conf.int # 信頼区間の出力（デフォルトで 95％信頼水準）\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1868.890 2033.498\nattr(,\"conf.level\")\n[1] 0.95\n```\n\n\n:::\n\n```{.r .cell-code}\n# コード5-6\nqnorm(0.025, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.959964\n```\n\n\n:::\n\n```{.r .cell-code}\n# 標準正規分布における上側 2.5％点の分位点を求める。\n\n# コード5-7\nn <- length(bulb)\nz <- qnorm(0.025, lower.tail = FALSE)\nxbar <- mean(bulb)\nsigma <- 180\n# 信頼区間の計算\nupper <- xbar + z * (sigma / sqrt(n))\nlower <- xbar - z * (sigma / sqrt(n))\n# 結果のまとめと出力\nci.bulb <- matrix(c(lower, upper), nrow = 1)\ncolnames(ci.bulb) <- c(\"ci.lower\", \"ci.upper\")\nknitr::kable(ci.bulb, caption = \"Bulb data CI (95％)\", align = \"cc\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Bulb data CI (95％)\n\n| ci.lower | ci.upper |\n|:--------:|:--------:|\n| 1862.995 | 2039.392 |\n\n\n:::\n\n```{.r .cell-code}\n# コード5-8\nmean(bulb)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1951.194\n```\n\n\n:::\n\n```{.r .cell-code}\n# コード5-9\nt.test(bulb, alternative = \"two.sided\", mu = 1800)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  bulb\nt = 3.9155, df = 15, p-value = 0.001377\nalternative hypothesis: true mean is not equal to 1800\n95 percent confidence interval:\n 1868.890 2033.498\nsample estimates:\nmean of x \n 1951.194 \n```\n\n\n:::\n\n```{.r .cell-code}\n# コード5-10\nn <- length(bulb)\nz <- qnorm(0.025, lower.tail = FALSE)\nxbar <- mean(bulb)\nsigma <- 180\nmu <- 1800\n#Test statistic\nZ <- (xbar - mu) / (sigma / sqrt(n))\nZ\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.359861\n```\n\n\n:::\n\n```{.r .cell-code}\n# コード5-11\nlibrary(tidyverse)\nfirmdata <- readxl::read_xlsx(\"data/MktRes_firmdata.xlsx\")\nfirm2018 <- firmdata %>%\n  filter(fyear == 2018) %>%\n  mutate(ad_dummy = ifelse(adint > median(adint), 1, 0))\nt.test(sales ~ ad_dummy, data = firm2018)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  sales by ad_dummy\nt = -3.3989, df = 85.686, p-value = 0.001029\nalternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0\n95 percent confidence interval:\n -1674283.1  -438496.1\nsample estimates:\nmean in group 0 mean in group 1 \n       725009.7       1781399.3 \n```\n\n\n:::\n\n```{.r .cell-code}\n# コード5-12\nvar.test(sales ~ ad_dummy, data = firm2018, ratio = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  sales by ad_dummy\nF = 0.10863, num df = 74, denom df = 71, p-value < 2.2e-16\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.06821636 0.17258882\nsample estimates:\nratio of variances \n         0.1086276 \n```\n\n\n:::\n\n```{.r .cell-code}\n# コード5-13\n\n\n# コード5-14\nest_n <- pwr.t.test(d = 0.8, power = 0.8, sig.level = 0.05)\nest_n\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     Two-sample t test power calculation \n\n              n = 25.52458\n              d = 0.8\n      sig.level = 0.05\n          power = 0.8\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n\n\n:::\n\n```{.r .cell-code}\n# コード5-15\nplot(est_n)\n```\n\n::: {.cell-output-display}\n![](chapter05_files/figure-pdf/unnamed-chunk-1-1.png){fig-align='center' fig-pos='H'}\n:::\n\n```{.r .cell-code}\n# コード5-16\npwr.t.test(d = 0.8, n = 26, sig.level = 0.05)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     Two-sample t test power calculation \n\n              n = 26\n              d = 0.8\n      sig.level = 0.05\n          power = 0.8074866\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n\n\n:::\n:::\n\n\n\n",
    "supporting": [
      "chapter05_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}